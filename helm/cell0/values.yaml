# Default values for cell0.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

global:
  imagePullSecrets: []
  imagePullPolicy: IfNotPresent

# -- Override the name of the chart
nameOverride: ""

# -- Override the full name of the chart
fullnameOverride: ""

# -- Common labels to add to all resources
commonLabels: {}

image:
  # -- Image registry
  registry: ghcr.io
  # -- Image repository
  repository: cell0-os/cell0
  # -- Image tag (defaults to chart appVersion)
  tag: ""
  # -- Image pull policy
  pullPolicy: IfNotPresent

# -- Number of replicas (ignored if autoscaling is enabled)
replicaCount: 2

# -- Deployment strategy
strategy:
  type: RollingUpdate
  rollingUpdate:
    maxSurge: 25%
    maxUnavailable: 0

# -- Service account configuration
serviceAccount:
  # -- Specifies whether a service account should be created
  create: true
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account to use.
  name: ""
  # -- Automount API credentials for a service account
  automountServiceAccountToken: false

# -- Pod security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000
  seccompProfile:
    type: RuntimeDefault

# -- Container security context
securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

# -- Service configuration
service:
  type: ClusterIP
  port: 18800
  metricsPort: 9090
  annotations: {}

# -- Ingress configuration
ingress:
  enabled: false
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
  hosts:
    - host: cell0.local
      paths:
        - path: /
          pathType: Prefix
  tls:
    enabled: false
    secretName: ""

# -- Resources configuration
resources:
  limits:
    cpu: 4000m
    memory: 8Gi
  requests:
    cpu: 500m
    memory: 2Gi

# -- Autoscaling configuration
autoscaling:
  enabled: false
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 60
      policies:
        - type: Percent
          value: 100
          periodSeconds: 60
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
        - type: Percent
          value: 10
          periodSeconds: 60

# -- Pod Disruption Budget configuration
podDisruptionBudget:
  enabled: true
  minAvailable: 1
  # maxUnavailable: 25%

# -- Node selector
nodeSelector: {}

# -- Tolerations
tolerations: []

# -- Affinity configuration
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - cell0
          topologyKey: kubernetes.io/hostname

# -- Pod topology spread constraints
topologySpreadConstraints: []

# -- Liveness probe configuration
livenessProbe:
  httpGet:
    path: /api/health/live
    port: http
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3
  successThreshold: 1

# -- Readiness probe configuration
readinessProbe:
  httpGet:
    path: /api/health/ready
    port: http
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3
  successThreshold: 1

# -- Startup probe configuration
startupProbe:
  httpGet:
    path: /api/health/startup
    port: http
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 30
  successThreshold: 1

# -- Persistence configuration
persistence:
  enabled: true
  storageClass: ""
  accessMode: ReadWriteOnce
  size: 10Gi
  annotations: {}

# -- Configuration settings
config:
  # -- Application environment
  env: production
  # -- Log level
  logLevel: INFO
  # -- Log format (json or text)
  logFormat: json
  # -- Host to bind to
  host: 0.0.0.0
  # -- Port to listen on
  port: 18800
  # -- Enable metrics endpoint
  metricsEnabled: true
  # -- Metrics port
  metricsPort: 9090
  # -- Number of workers
  workers: 4
  # -- Maximum connections
  maxConnections: 1000
  # -- Request timeout in seconds
  requestTimeout: 300
  # -- WebSocket timeout in seconds
  websocketTimeout: 3600
  
  # -- Feature flags
  features:
    swarm: true
    canvas: true
    signal: true
    tts: false
  
  # -- Integration URLs
  ollamaUrl: http://ollama:11434
  redisUrl: redis://redis:6379/0
  
  # -- Security settings
  security:
    corsOrigins: "*"
    rateLimitEnabled: true
    rateLimitRequests: 100
    rateLimitWindow: 60

# -- Secrets configuration
# Use existingSecret to reference an existing secret
existingSecret: ""

# -- Secret values (only used if existingSecret is not set)
secrets:
  CELL0_SECRET_KEY: "change-me-in-production-at-least-32-bytes"
  BRAVE_API_KEY: ""
  TAVILY_API_KEY: ""
  SERPAPI_KEY: ""
  SIGNAL_ACCOUNT: ""
  SIGNAL_PASSWORD: ""
  SENTRY_DSN: ""
  OAUTH_CLIENT_ID: ""
  OAUTH_CLIENT_SECRET: ""

# -- ServiceMonitor configuration for Prometheus Operator
serviceMonitor:
  enabled: false
  namespace: ""
  interval: 30s
  scrapeTimeout: 10s
  labels: {}
  annotations: {}
  relabelings: []
  metricRelabelings: []

# -- PrometheusRule configuration
prometheusRule:
  enabled: false
  namespace: ""
  labels: {}
  annotations: {}
  rules: []

# -- Network policies
networkPolicy:
  enabled: false
  ingress: []
  egress: []

# -- Pod annotations
podAnnotations: {}

# -- Additional environment variables
extraEnv: []

# -- Additional environment variables from config maps or secrets
extraEnvFrom: []

# -- Additional volumes
extraVolumes: []

# -- Additional volume mounts
extraVolumeMounts: []

# -- Additional containers (sidecars)
sidecars: []

# -- Init containers
initContainers: []

# -- Redis dependency configuration
redis:
  enabled: true
  architecture: standalone
  auth:
    enabled: false
  master:
    persistence:
      enabled: true
      size: 8Gi

# -- PostgreSQL dependency configuration
postgresql:
  enabled: false
  auth:
    username: cell0
    database: cell0
    existingSecret: ""
  primary:
    persistence:
      enabled: true
      size: 10Gi
